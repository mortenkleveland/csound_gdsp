<!DOCTYPE html>
<html>
<head>
    <title>Csound GDSP</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript" src="wavesurfer.min.js"></script>
    <script type="text/javascript" src="csound.js"></script>
    <script type="text/javascript" src="script.js"></script>
    <script src="jquery.knob.min.js"></script>
</head>

<body>

    <div id="">
    <input type="file" id="openFileButton" value="Open file">
    <input type="button" id="playButton" value="Play">
    <input type="button" id="switchInstanceButton" value="A/B">

    <div class="center" id="potmeters">
        <input id="knob1" class="knob" data-width="150" data-angleOffset="180" angleArc="100" data-fgColor="#C0ffff" data-skin="tron" data-thickness=".1" value="0.5" data-min="0" data-max="1" data-step=".001">
        <input id="knob2" class="knob" data-width="150" data-angleOffset="210" angleArc="240" data-fgColor="#C0ffff" data-skin="tron" data-thickness=".1" value="5000" data-min="1000" data-max="12000" data-step="1">
        <input id="knob3" class="knob" data-width="150" data-angleOffset="210" angleArc="240" data-fgColor="#C0ffff" data-skin="tron" data-thickness=".1" value="-90"> 
    </div>

    <div id="waveform">
        <div class="progress progress-striped active" id="progress-bar">
            <div class="progress-bar progress-bar-info"></div>
        </div>

        <!-- Here be the waveform -->
    </div>

    <p class="lead pull-center center" id="drop">
        Dra og slipp lydfilen din her.
    </p>

    <textarea id="orchestraField" hidden>
        instr 1
            Sfile = "./local/soundfile"
            kAmp chnget "targetSoundAmplitude"
            aDry diskin2 Sfile, 1, 0, 1
            aDry *= kAmp
            aDry *= 0.5
            chnset aDry, "reverbLTarget"
            chnset aDry, "reverbRTarget"
        endin

        instr 2
            Sfile = "./local/soundfile"
            kParam1 chnget "param1" 
            kParam2 chnget "param2"
            kAmp chnget "userSoundAmplitude"
            aDry diskin2 Sfile, 1, 0, 1
            aDry *= kAmp
            aDry *= 0.5
            chnset aDry * sqrt(kParam1), "reverbL"
            chnset aDry * sqrt(kParam1), "reverbR"
            chnset aDry * sqrt(1 - kParam1), "masterL"
            chnset aDry * sqrt(1 - kParam1), "masterR"
        endin

        ; Static target effects
        instr 10
            aDryL chnget "reverbLTarget"
            aDryR chnget "reverbRTarget"
            kParam1 = 0.1
            kParam2 = 4000
            aWetL, aWetR reverbsc aDryL, aDryR, kParam1, kParam2
            chnmix aDryL * sqrt(1 - kParam1), "masterL"
            chnmix aDryR * sqrt(1 - kParam1), "masterR"
            chnmix aWetL * sqrt(kParam1), "masterL"
            chnmix aWetR * sqrt(kParam1), "masterR"
            chnclear "reverbLTarget"
            chnclear "reverbRTarget"
        endin

        ; User realtime tweakable effects
        instr 90
            aL chnget "reverbL"
            aR chnget "reverbR"
            kParam1 chnget "param1"
            kParam2 chnget "param2"
            aWetL, aWetR reverbsc aL, aR, kParam1, kParam2
            chnmix aWetL, "masterL"
            chnmix aWetR, "masterR"
            chnclear "reverbL"
            chnclear "reverbR"
        endin

        instr 99
            aL chnget "masterL"
            aR chnget "masterR"
            outs aL, aR
            chnclear "masterL"
            chnclear "masterR"
        endin
    </textarea>
    
    <!--pNaCl csound module-->
    <div id="engine"></div>
</body>
</html>

